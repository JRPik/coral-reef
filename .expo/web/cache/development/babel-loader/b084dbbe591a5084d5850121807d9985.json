{"ast":null,"code":"'use strict';\n\nvar _toConsumableArray = require(\"@babel/runtime/helpers/toConsumableArray\");\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\n\nvar ErrorUtils = require(\"../vendor/core/ErrorUtils\");\n\nvar Systrace = require(\"../Performance/Systrace\");\n\nvar deepFreezeAndThrowOnMutationInDev = require(\"../Utilities/deepFreezeAndThrowOnMutationInDev\");\n\nvar invariant = require('invariant');\n\nvar stringifySafe = require(\"../Utilities/stringifySafe\").default;\n\nvar warnOnce = require(\"../Utilities/warnOnce\");\n\nvar TO_JS = 0;\nvar TO_NATIVE = 1;\nvar MODULE_IDS = 0;\nvar METHOD_IDS = 1;\nvar PARAMS = 2;\nvar MIN_TIME_BETWEEN_FLUSHES_MS = 5;\nvar TRACE_TAG_REACT_APPS = 1 << 17;\nvar DEBUG_INFO_LIMIT = 32;\n\nvar MessageQueue = function () {\n  function MessageQueue() {\n    _classCallCheck(this, MessageQueue);\n\n    this._lazyCallableModules = {};\n    this._queue = [[], [], [], 0];\n    this._successCallbacks = new Map();\n    this._failureCallbacks = new Map();\n    this._callID = 0;\n    this._lastFlush = 0;\n    this._eventLoopStartTime = Date.now();\n    this._immediatesCallback = null;\n\n    if (__DEV__) {\n      this._debugInfo = {};\n      this._remoteModuleTable = {};\n      this._remoteMethodTable = {};\n    }\n\n    this.callFunctionReturnFlushedQueue = this.callFunctionReturnFlushedQueue.bind(this);\n    this.flushedQueue = this.flushedQueue.bind(this);\n    this.invokeCallbackAndReturnFlushedQueue = this.invokeCallbackAndReturnFlushedQueue.bind(this);\n  }\n\n  _createClass(MessageQueue, [{\n    key: \"callFunctionReturnFlushedQueue\",\n    value: function callFunctionReturnFlushedQueue(module, method, args) {\n      var _this = this;\n\n      this.__guard(function () {\n        _this.__callFunction(module, method, args);\n      });\n\n      return this.flushedQueue();\n    }\n  }, {\n    key: \"invokeCallbackAndReturnFlushedQueue\",\n    value: function invokeCallbackAndReturnFlushedQueue(cbID, args) {\n      var _this2 = this;\n\n      this.__guard(function () {\n        _this2.__invokeCallback(cbID, args);\n      });\n\n      return this.flushedQueue();\n    }\n  }, {\n    key: \"flushedQueue\",\n    value: function flushedQueue() {\n      var _this3 = this;\n\n      this.__guard(function () {\n        _this3.__callImmediates();\n      });\n\n      var queue = this._queue;\n      this._queue = [[], [], [], this._callID];\n      return queue[0].length ? queue : null;\n    }\n  }, {\n    key: \"getEventLoopRunningTime\",\n    value: function getEventLoopRunningTime() {\n      return Date.now() - this._eventLoopStartTime;\n    }\n  }, {\n    key: \"registerCallableModule\",\n    value: function registerCallableModule(name, module) {\n      this._lazyCallableModules[name] = function () {\n        return module;\n      };\n    }\n  }, {\n    key: \"registerLazyCallableModule\",\n    value: function registerLazyCallableModule(name, factory) {\n      var module;\n      var getValue = factory;\n\n      this._lazyCallableModules[name] = function () {\n        if (getValue) {\n          module = getValue();\n          getValue = null;\n        }\n\n        return module;\n      };\n    }\n  }, {\n    key: \"getCallableModule\",\n    value: function getCallableModule(name) {\n      var getValue = this._lazyCallableModules[name];\n      return getValue ? getValue() : null;\n    }\n  }, {\n    key: \"callNativeSyncHook\",\n    value: function callNativeSyncHook(moduleID, methodID, params, onFail, onSucc) {\n      if (__DEV__) {\n        invariant(global.nativeCallSyncHook, 'Calling synchronous methods on native ' + 'modules is not supported in Chrome.\\n\\n Consider providing alternative ' + 'methods to expose this method in debug mode, e.g. by exposing constants ' + 'ahead-of-time.');\n      }\n\n      this.processCallbacks(moduleID, methodID, params, onFail, onSucc);\n      return global.nativeCallSyncHook(moduleID, methodID, params);\n    }\n  }, {\n    key: \"processCallbacks\",\n    value: function processCallbacks(moduleID, methodID, params, onFail, onSucc) {\n      var _this4 = this;\n\n      if (onFail || onSucc) {\n        if (__DEV__) {\n          this._debugInfo[this._callID] = [moduleID, methodID];\n\n          if (this._callID > DEBUG_INFO_LIMIT) {\n            delete this._debugInfo[this._callID - DEBUG_INFO_LIMIT];\n          }\n\n          if (this._successCallbacks.size > 500) {\n            var info = {};\n\n            this._successCallbacks.forEach(function (_, callID) {\n              var debug = _this4._debugInfo[callID];\n              var module = debug && _this4._remoteModuleTable[debug[0]];\n              var method = debug && _this4._remoteMethodTable[debug[0]][debug[1]];\n              info[callID] = {\n                module: module,\n                method: method\n              };\n            });\n\n            warnOnce('excessive-number-of-pending-callbacks', \"Please report: Excessive number of pending callbacks: \" + this._successCallbacks.size + \". Some pending callbacks that might have leaked by never being called from native code: \" + stringifySafe(info));\n          }\n        }\n\n        onFail && params.push(this._callID << 1);\n        onSucc && params.push(this._callID << 1 | 1);\n\n        this._successCallbacks.set(this._callID, onSucc);\n\n        this._failureCallbacks.set(this._callID, onFail);\n      }\n\n      if (__DEV__) {\n        global.nativeTraceBeginAsyncFlow && global.nativeTraceBeginAsyncFlow(TRACE_TAG_REACT_APPS, 'native', this._callID);\n      }\n\n      this._callID++;\n    }\n  }, {\n    key: \"enqueueNativeCall\",\n    value: function enqueueNativeCall(moduleID, methodID, params, onFail, onSucc) {\n      this.processCallbacks(moduleID, methodID, params, onFail, onSucc);\n\n      this._queue[MODULE_IDS].push(moduleID);\n\n      this._queue[METHOD_IDS].push(methodID);\n\n      if (__DEV__) {\n        var isValidArgument = function isValidArgument(val) {\n          switch (typeof val) {\n            case 'undefined':\n            case 'boolean':\n            case 'string':\n              return true;\n\n            case 'number':\n              return isFinite(val);\n\n            case 'object':\n              if (val == null) {\n                return true;\n              }\n\n              if (Array.isArray(val)) {\n                return val.every(isValidArgument);\n              }\n\n              for (var k in val) {\n                if (typeof val[k] !== 'function' && !isValidArgument(val[k])) {\n                  return false;\n                }\n              }\n\n              return true;\n\n            case 'function':\n              return false;\n\n            default:\n              return false;\n          }\n        };\n\n        var replacer = function replacer(key, val) {\n          var t = typeof val;\n\n          if (t === 'function') {\n            return '<<Function ' + val.name + '>>';\n          } else if (t === 'number' && !isFinite(val)) {\n            return '<<' + val.toString() + '>>';\n          } else {\n            return val;\n          }\n        };\n\n        invariant(isValidArgument(params), '%s is not usable as a native method argument', JSON.stringify(params, replacer));\n        deepFreezeAndThrowOnMutationInDev(params);\n      }\n\n      this._queue[PARAMS].push(params);\n\n      var now = Date.now();\n\n      if (global.nativeFlushQueueImmediate && now - this._lastFlush >= MIN_TIME_BETWEEN_FLUSHES_MS) {\n        var queue = this._queue;\n        this._queue = [[], [], [], this._callID];\n        this._lastFlush = now;\n        global.nativeFlushQueueImmediate(queue);\n      }\n\n      Systrace.counterEvent('pending_js_to_native_queue', this._queue[0].length);\n\n      if (__DEV__ && this.__spy && isFinite(moduleID)) {\n        this.__spy({\n          type: TO_NATIVE,\n          module: this._remoteModuleTable[moduleID],\n          method: this._remoteMethodTable[moduleID][methodID],\n          args: params\n        });\n      } else if (this.__spy) {\n        this.__spy({\n          type: TO_NATIVE,\n          module: moduleID + '',\n          method: methodID,\n          args: params\n        });\n      }\n    }\n  }, {\n    key: \"createDebugLookup\",\n    value: function createDebugLookup(moduleID, name, methods) {\n      if (__DEV__) {\n        this._remoteModuleTable[moduleID] = name;\n        this._remoteMethodTable[moduleID] = methods || [];\n      }\n    }\n  }, {\n    key: \"setImmediatesCallback\",\n    value: function setImmediatesCallback(fn) {\n      this._immediatesCallback = fn;\n    }\n  }, {\n    key: \"__guard\",\n    value: function __guard(fn) {\n      if (this.__shouldPauseOnThrow()) {\n        fn();\n      } else {\n        try {\n          fn();\n        } catch (error) {\n          ErrorUtils.reportFatalError(error);\n        }\n      }\n    }\n  }, {\n    key: \"__shouldPauseOnThrow\",\n    value: function __shouldPauseOnThrow() {\n      return typeof DebuggerInternal !== 'undefined' && DebuggerInternal.shouldPauseOnThrow === true;\n    }\n  }, {\n    key: \"__callImmediates\",\n    value: function __callImmediates() {\n      Systrace.beginEvent('JSTimers.callImmediates()');\n\n      if (this._immediatesCallback != null) {\n        this._immediatesCallback();\n      }\n\n      Systrace.endEvent();\n    }\n  }, {\n    key: \"__callFunction\",\n    value: function __callFunction(module, method, args) {\n      this._lastFlush = Date.now();\n      this._eventLoopStartTime = this._lastFlush;\n\n      if (__DEV__ || this.__spy) {\n        Systrace.beginEvent(module + \".\" + method + \"(\" + stringifySafe(args) + \")\");\n      } else {\n        Systrace.beginEvent(module + \".\" + method + \"(...)\");\n      }\n\n      if (this.__spy) {\n        this.__spy({\n          type: TO_JS,\n          module: module,\n          method: method,\n          args: args\n        });\n      }\n\n      var moduleMethods = this.getCallableModule(module);\n      invariant(!!moduleMethods, \"Module \" + module + \" is not a registered callable module (calling \" + method + \"). A frequent cause of the error is that the application entry file path is incorrect. \\n      This can also happen when the JS bundle is corrupt or there is an early initialization error when loading React Native.\");\n      invariant(!!moduleMethods[method], \"Method \" + method + \" does not exist on module \" + module);\n      moduleMethods[method].apply(moduleMethods, args);\n      Systrace.endEvent();\n    }\n  }, {\n    key: \"__invokeCallback\",\n    value: function __invokeCallback(cbID, args) {\n      this._lastFlush = Date.now();\n      this._eventLoopStartTime = this._lastFlush;\n      var callID = cbID >>> 1;\n      var isSuccess = cbID & 1;\n      var callback = isSuccess ? this._successCallbacks.get(callID) : this._failureCallbacks.get(callID);\n\n      if (__DEV__) {\n        var debug = this._debugInfo[callID];\n\n        var _module = debug && this._remoteModuleTable[debug[0]];\n\n        var method = debug && this._remoteMethodTable[debug[0]][debug[1]];\n        invariant(callback, \"No callback found with cbID \" + cbID + \" and callID \" + callID + \" for \" + (method ? \" \" + _module + \".\" + method + \" - most likely the callback was already invoked\" : \"module \" + (_module || '<unknown>')) + (\". Args: '\" + stringifySafe(args) + \"'\"));\n        var profileName = debug ? '<callback for ' + _module + '.' + method + '>' : cbID;\n\n        if (callback && this.__spy) {\n          this.__spy({\n            type: TO_JS,\n            module: null,\n            method: profileName,\n            args: args\n          });\n        }\n\n        Systrace.beginEvent(\"MessageQueue.invokeCallback(\" + profileName + \", \" + stringifySafe(args) + \")\");\n      }\n\n      if (!callback) {\n        return;\n      }\n\n      this._successCallbacks.delete(callID);\n\n      this._failureCallbacks.delete(callID);\n\n      callback.apply(void 0, _toConsumableArray(args));\n\n      if (__DEV__) {\n        Systrace.endEvent();\n      }\n    }\n  }], [{\n    key: \"spy\",\n    value: function spy(spyOrToggle) {\n      if (spyOrToggle === true) {\n        MessageQueue.prototype.__spy = function (info) {\n          console.log((info.type === TO_JS ? 'N->JS' : 'JS->N') + \" : \" + (\"\" + (info.module != null ? info.module + '.' : '') + info.method) + (\"(\" + JSON.stringify(info.args) + \")\"));\n        };\n      } else if (spyOrToggle === false) {\n        MessageQueue.prototype.__spy = null;\n      } else {\n        MessageQueue.prototype.__spy = spyOrToggle;\n      }\n    }\n  }]);\n\n  return MessageQueue;\n}();\n\nmodule.exports = MessageQueue;","map":{"version":3,"sources":["D:/Senior Design/coral-reef/node_modules/react-native/Libraries/BatchedBridge/MessageQueue.js"],"names":["ErrorUtils","require","Systrace","deepFreezeAndThrowOnMutationInDev","invariant","stringifySafe","default","warnOnce","TO_JS","TO_NATIVE","MODULE_IDS","METHOD_IDS","PARAMS","MIN_TIME_BETWEEN_FLUSHES_MS","TRACE_TAG_REACT_APPS","DEBUG_INFO_LIMIT","MessageQueue","_lazyCallableModules","_queue","_successCallbacks","Map","_failureCallbacks","_callID","_lastFlush","_eventLoopStartTime","Date","now","_immediatesCallback","__DEV__","_debugInfo","_remoteModuleTable","_remoteMethodTable","callFunctionReturnFlushedQueue","bind","flushedQueue","invokeCallbackAndReturnFlushedQueue","module","method","args","__guard","__callFunction","cbID","__invokeCallback","__callImmediates","queue","length","name","factory","getValue","moduleID","methodID","params","onFail","onSucc","global","nativeCallSyncHook","processCallbacks","size","info","forEach","_","callID","debug","push","set","nativeTraceBeginAsyncFlow","isValidArgument","val","isFinite","Array","isArray","every","k","replacer","key","t","toString","JSON","stringify","nativeFlushQueueImmediate","counterEvent","__spy","type","methods","fn","__shouldPauseOnThrow","error","reportFatalError","DebuggerInternal","shouldPauseOnThrow","beginEvent","endEvent","moduleMethods","getCallableModule","apply","isSuccess","callback","get","profileName","delete","spyOrToggle","prototype","console","log","exports"],"mappings":"AAUA;;;;;;;;AAEA,IAAMA,UAAU,GAAGC,OAAO,6BAA1B;;AACA,IAAMC,QAAQ,GAAGD,OAAO,2BAAxB;;AAEA,IAAME,iCAAiC,GAAGF,OAAO,kDAAjD;;AACA,IAAMG,SAAS,GAAGH,OAAO,CAAC,WAAD,CAAzB;;AACA,IAAMI,aAAa,GAAGJ,OAAO,8BAAP,CAAsCK,OAA5D;;AACA,IAAMC,QAAQ,GAAGN,OAAO,yBAAxB;;AAUA,IAAMO,KAAK,GAAG,CAAd;AACA,IAAMC,SAAS,GAAG,CAAlB;AAEA,IAAMC,UAAU,GAAG,CAAnB;AACA,IAAMC,UAAU,GAAG,CAAnB;AACA,IAAMC,MAAM,GAAG,CAAf;AACA,IAAMC,2BAA2B,GAAG,CAApC;AAGA,IAAMC,oBAAoB,GAAG,KAAK,EAAlC;AAEA,IAAMC,gBAAgB,GAAG,EAAzB;;IAEMC,Y;AAgBJ,0BAAc;AAAA;;AACZ,SAAKC,oBAAL,GAA4B,EAA5B;AACA,SAAKC,MAAL,GAAc,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,CAAb,CAAd;AACA,SAAKC,iBAAL,GAAyB,IAAIC,GAAJ,EAAzB;AACA,SAAKC,iBAAL,GAAyB,IAAID,GAAJ,EAAzB;AACA,SAAKE,OAAL,GAAe,CAAf;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAKC,mBAAL,GAA2BC,IAAI,CAACC,GAAL,EAA3B;AACA,SAAKC,mBAAL,GAA2B,IAA3B;;AAEA,QAAIC,OAAJ,EAAa;AACX,WAAKC,UAAL,GAAkB,EAAlB;AACA,WAAKC,kBAAL,GAA0B,EAA1B;AACA,WAAKC,kBAAL,GAA0B,EAA1B;AACD;;AAGD,SAAKC,8BAAL,GAAsC,KAAKA,8BAAL,CAAoCC,IAApC,CACpC,IADoC,CAAtC;AAIA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AAGA,SAAKE,mCAAL,GAA2C,KAAKA,mCAAL,CAAyCF,IAAzC,CACzC,IADyC,CAA3C;AAGD;;;;WAsBD,wCACEG,MADF,EAEEC,MAFF,EAGEC,IAHF,EAI+D;AAAA;;AAC7D,WAAKC,OAAL,CAAa,YAAM;AACjB,QAAA,KAAI,CAACC,cAAL,CAAoBJ,MAApB,EAA4BC,MAA5B,EAAoCC,IAApC;AACD,OAFD;;AAIA,aAAO,KAAKJ,YAAL,EAAP;AACD;;;WAED,6CACEO,IADF,EAEEH,IAFF,EAG+D;AAAA;;AAC7D,WAAKC,OAAL,CAAa,YAAM;AACjB,QAAA,MAAI,CAACG,gBAAL,CAAsBD,IAAtB,EAA4BH,IAA5B;AACD,OAFD;;AAIA,aAAO,KAAKJ,YAAL,EAAP;AACD;;;WAED,wBAA4E;AAAA;;AAC1E,WAAKK,OAAL,CAAa,YAAM;AACjB,QAAA,MAAI,CAACI,gBAAL;AACD,OAFD;;AAIA,UAAMC,KAAK,GAAG,KAAK1B,MAAnB;AACA,WAAKA,MAAL,GAAc,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,KAAKI,OAAlB,CAAd;AACA,aAAOsB,KAAK,CAAC,CAAD,CAAL,CAASC,MAAT,GAAkBD,KAAlB,GAA0B,IAAjC;AACD;;;WAED,mCAAkC;AAChC,aAAOnB,IAAI,CAACC,GAAL,KAAa,KAAKF,mBAAzB;AACD;;;WAED,gCAAuBsB,IAAvB,EAAqCV,MAArC,EAAoD;AAClD,WAAKnB,oBAAL,CAA0B6B,IAA1B,IAAkC;AAAA,eAAMV,MAAN;AAAA,OAAlC;AACD;;;WAED,oCAA2BU,IAA3B,EAAyCC,OAAzC,EAAiE;AAC/D,UAAIX,MAAJ;AACA,UAAIY,QAA0B,GAAGD,OAAjC;;AACA,WAAK9B,oBAAL,CAA0B6B,IAA1B,IAAkC,YAAM;AACtC,YAAIE,QAAJ,EAAc;AACZZ,UAAAA,MAAM,GAAGY,QAAQ,EAAjB;AACAA,UAAAA,QAAQ,GAAG,IAAX;AACD;;AACD,eAAOZ,MAAP;AACD,OAND;AAOD;;;WAED,2BAAkBU,IAAlB,EAA8C;AAC5C,UAAME,QAAQ,GAAG,KAAK/B,oBAAL,CAA0B6B,IAA1B,CAAjB;AACA,aAAOE,QAAQ,GAAGA,QAAQ,EAAX,GAAgB,IAA/B;AACD;;;WAED,4BACEC,QADF,EAEEC,QAFF,EAGEC,MAHF,EAIEC,MAJF,EAKEC,MALF,EAMS;AACP,UAAIzB,OAAJ,EAAa;AACXxB,QAAAA,SAAS,CACPkD,MAAM,CAACC,kBADA,EAEP,2CACE,yEADF,GAEE,0EAFF,GAGE,gBALK,CAAT;AAOD;;AACD,WAAKC,gBAAL,CAAsBP,QAAtB,EAAgCC,QAAhC,EAA0CC,MAA1C,EAAkDC,MAAlD,EAA0DC,MAA1D;AACA,aAAOC,MAAM,CAACC,kBAAP,CAA0BN,QAA1B,EAAoCC,QAApC,EAA8CC,MAA9C,CAAP;AACD;;;WAED,0BACEF,QADF,EAEEC,QAFF,EAGEC,MAHF,EAIEC,MAJF,EAKEC,MALF,EAMQ;AAAA;;AACN,UAAID,MAAM,IAAIC,MAAd,EAAsB;AACpB,YAAIzB,OAAJ,EAAa;AACX,eAAKC,UAAL,CAAgB,KAAKP,OAArB,IAAgC,CAAC2B,QAAD,EAAWC,QAAX,CAAhC;;AACA,cAAI,KAAK5B,OAAL,GAAeP,gBAAnB,EAAqC;AACnC,mBAAO,KAAKc,UAAL,CAAgB,KAAKP,OAAL,GAAeP,gBAA/B,CAAP;AACD;;AACD,cAAI,KAAKI,iBAAL,CAAuBsC,IAAvB,GAA8B,GAAlC,EAAuC;AACrC,gBAAMC,IAAI,GAAG,EAAb;;AACA,iBAAKvC,iBAAL,CAAuBwC,OAAvB,CAA+B,UAACC,CAAD,EAAIC,MAAJ,EAAe;AAC5C,kBAAMC,KAAK,GAAG,MAAI,CAACjC,UAAL,CAAgBgC,MAAhB,CAAd;AACA,kBAAMzB,MAAM,GAAG0B,KAAK,IAAI,MAAI,CAAChC,kBAAL,CAAwBgC,KAAK,CAAC,CAAD,CAA7B,CAAxB;AACA,kBAAMzB,MAAM,GAAGyB,KAAK,IAAI,MAAI,CAAC/B,kBAAL,CAAwB+B,KAAK,CAAC,CAAD,CAA7B,EAAkCA,KAAK,CAAC,CAAD,CAAvC,CAAxB;AACAJ,cAAAA,IAAI,CAACG,MAAD,CAAJ,GAAe;AAACzB,gBAAAA,MAAM,EAANA,MAAD;AAASC,gBAAAA,MAAM,EAANA;AAAT,eAAf;AACD,aALD;;AAMA9B,YAAAA,QAAQ,CACN,uCADM,6DAGJ,KAAKY,iBAAL,CAAuBsC,IAHnB,gGAIqFpD,aAAa,CACtGqD,IADsG,CAJlG,CAAR;AAQD;AACF;;AAIDN,QAAAA,MAAM,IAAID,MAAM,CAACY,IAAP,CAAY,KAAKzC,OAAL,IAAgB,CAA5B,CAAV;AAEA+B,QAAAA,MAAM,IAAIF,MAAM,CAACY,IAAP,CAAa,KAAKzC,OAAL,IAAgB,CAAjB,GAAsB,CAAlC,CAAV;;AACA,aAAKH,iBAAL,CAAuB6C,GAAvB,CAA2B,KAAK1C,OAAhC,EAAyC+B,MAAzC;;AACA,aAAKhC,iBAAL,CAAuB2C,GAAvB,CAA2B,KAAK1C,OAAhC,EAAyC8B,MAAzC;AACD;;AACD,UAAIxB,OAAJ,EAAa;AACX0B,QAAAA,MAAM,CAACW,yBAAP,IACEX,MAAM,CAACW,yBAAP,CACEnD,oBADF,EAEE,QAFF,EAGE,KAAKQ,OAHP,CADF;AAMD;;AACD,WAAKA,OAAL;AACD;;;WAED,2BACE2B,QADF,EAEEC,QAFF,EAGEC,MAHF,EAIEC,MAJF,EAKEC,MALF,EAME;AACA,WAAKG,gBAAL,CAAsBP,QAAtB,EAAgCC,QAAhC,EAA0CC,MAA1C,EAAkDC,MAAlD,EAA0DC,MAA1D;;AAEA,WAAKnC,MAAL,CAAYR,UAAZ,EAAwBqD,IAAxB,CAA6Bd,QAA7B;;AACA,WAAK/B,MAAL,CAAYP,UAAZ,EAAwBoD,IAAxB,CAA6Bb,QAA7B;;AAEA,UAAItB,OAAJ,EAAa;AAKX,YAAMsC,eAAe,GAAG,SAAlBA,eAAkB,CAAAC,GAAG,EAAI;AAC7B,kBAAQ,OAAOA,GAAf;AACE,iBAAK,WAAL;AACA,iBAAK,SAAL;AACA,iBAAK,QAAL;AACE,qBAAO,IAAP;;AACF,iBAAK,QAAL;AACE,qBAAOC,QAAQ,CAACD,GAAD,CAAf;;AACF,iBAAK,QAAL;AACE,kBAAIA,GAAG,IAAI,IAAX,EAAiB;AACf,uBAAO,IAAP;AACD;;AAED,kBAAIE,KAAK,CAACC,OAAN,CAAcH,GAAd,CAAJ,EAAwB;AACtB,uBAAOA,GAAG,CAACI,KAAJ,CAAUL,eAAV,CAAP;AACD;;AAED,mBAAK,IAAMM,CAAX,IAAgBL,GAAhB,EAAqB;AACnB,oBAAI,OAAOA,GAAG,CAACK,CAAD,CAAV,KAAkB,UAAlB,IAAgC,CAACN,eAAe,CAACC,GAAG,CAACK,CAAD,CAAJ,CAApD,EAA8D;AAC5D,yBAAO,KAAP;AACD;AACF;;AAED,qBAAO,IAAP;;AACF,iBAAK,UAAL;AACE,qBAAO,KAAP;;AACF;AACE,qBAAO,KAAP;AA1BJ;AA4BD,SA7BD;;AAkCA,YAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD,EAAMP,GAAN,EAAc;AAC7B,cAAMQ,CAAC,GAAG,OAAOR,GAAjB;;AACA,cAAIQ,CAAC,KAAK,UAAV,EAAsB;AACpB,mBAAO,gBAAgBR,GAAG,CAACrB,IAApB,GAA2B,IAAlC;AACD,WAFD,MAEO,IAAI6B,CAAC,KAAK,QAAN,IAAkB,CAACP,QAAQ,CAACD,GAAD,CAA/B,EAAsC;AAC3C,mBAAO,OAAOA,GAAG,CAACS,QAAJ,EAAP,GAAwB,IAA/B;AACD,WAFM,MAEA;AACL,mBAAOT,GAAP;AACD;AACF,SATD;;AAYA/D,QAAAA,SAAS,CACP8D,eAAe,CAACf,MAAD,CADR,EAEP,8CAFO,EAGP0B,IAAI,CAACC,SAAL,CAAe3B,MAAf,EAAuBsB,QAAvB,CAHO,CAAT;AAOAtE,QAAAA,iCAAiC,CAACgD,MAAD,CAAjC;AACD;;AACD,WAAKjC,MAAL,CAAYN,MAAZ,EAAoBmD,IAApB,CAAyBZ,MAAzB;;AAEA,UAAMzB,GAAG,GAAGD,IAAI,CAACC,GAAL,EAAZ;;AACA,UACE4B,MAAM,CAACyB,yBAAP,IACArD,GAAG,GAAG,KAAKH,UAAX,IAAyBV,2BAF3B,EAGE;AACA,YAAM+B,KAAK,GAAG,KAAK1B,MAAnB;AACA,aAAKA,MAAL,GAAc,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,KAAKI,OAAlB,CAAd;AACA,aAAKC,UAAL,GAAkBG,GAAlB;AACA4B,QAAAA,MAAM,CAACyB,yBAAP,CAAiCnC,KAAjC;AACD;;AACD1C,MAAAA,QAAQ,CAAC8E,YAAT,CAAsB,4BAAtB,EAAoD,KAAK9D,MAAL,CAAY,CAAZ,EAAe2B,MAAnE;;AACA,UAAIjB,OAAO,IAAI,KAAKqD,KAAhB,IAAyBb,QAAQ,CAACnB,QAAD,CAArC,EAAiD;AAC/C,aAAKgC,KAAL,CAAW;AACTC,UAAAA,IAAI,EAAEzE,SADG;AAET2B,UAAAA,MAAM,EAAE,KAAKN,kBAAL,CAAwBmB,QAAxB,CAFC;AAGTZ,UAAAA,MAAM,EAAE,KAAKN,kBAAL,CAAwBkB,QAAxB,EAAkCC,QAAlC,CAHC;AAITZ,UAAAA,IAAI,EAAEa;AAJG,SAAX;AAMD,OAPD,MAOO,IAAI,KAAK8B,KAAT,EAAgB;AACrB,aAAKA,KAAL,CAAW;AACTC,UAAAA,IAAI,EAAEzE,SADG;AAET2B,UAAAA,MAAM,EAAEa,QAAQ,GAAG,EAFV;AAGTZ,UAAAA,MAAM,EAAEa,QAHC;AAITZ,UAAAA,IAAI,EAAEa;AAJG,SAAX;AAMD;AACF;;;WAED,2BACEF,QADF,EAEEH,IAFF,EAGEqC,OAHF,EAIE;AACA,UAAIvD,OAAJ,EAAa;AACX,aAAKE,kBAAL,CAAwBmB,QAAxB,IAAoCH,IAApC;AACA,aAAKf,kBAAL,CAAwBkB,QAAxB,IAAoCkC,OAAO,IAAI,EAA/C;AACD;AACF;;;WAKD,+BAAsBC,EAAtB,EAAsC;AACpC,WAAKzD,mBAAL,GAA2ByD,EAA3B;AACD;;;WAMD,iBAAQA,EAAR,EAAwB;AACtB,UAAI,KAAKC,oBAAL,EAAJ,EAAiC;AAC/BD,QAAAA,EAAE;AACH,OAFD,MAEO;AACL,YAAI;AACFA,UAAAA,EAAE;AACH,SAFD,CAEE,OAAOE,KAAP,EAAc;AACdtF,UAAAA,UAAU,CAACuF,gBAAX,CAA4BD,KAA5B;AACD;AACF;AACF;;;WAOD,gCAAgC;AAC9B,aAEE,OAAOE,gBAAP,KAA4B,WAA5B,IACAA,gBAAgB,CAACC,kBAAjB,KAAwC,IAH1C;AAKD;;;WAED,4BAAmB;AACjBvF,MAAAA,QAAQ,CAACwF,UAAT,CAAoB,2BAApB;;AACA,UAAI,KAAK/D,mBAAL,IAA4B,IAAhC,EAAsC;AACpC,aAAKA,mBAAL;AACD;;AACDzB,MAAAA,QAAQ,CAACyF,QAAT;AACD;;;WAED,wBAAevD,MAAf,EAA+BC,MAA/B,EAA+CC,IAA/C,EAAoE;AAClE,WAAKf,UAAL,GAAkBE,IAAI,CAACC,GAAL,EAAlB;AACA,WAAKF,mBAAL,GAA2B,KAAKD,UAAhC;;AACA,UAAIK,OAAO,IAAI,KAAKqD,KAApB,EAA2B;AACzB/E,QAAAA,QAAQ,CAACwF,UAAT,CAAuBtD,MAAvB,SAAiCC,MAAjC,SAA2ChC,aAAa,CAACiC,IAAD,CAAxD;AACD,OAFD,MAEO;AACLpC,QAAAA,QAAQ,CAACwF,UAAT,CAAuBtD,MAAvB,SAAiCC,MAAjC;AACD;;AACD,UAAI,KAAK4C,KAAT,EAAgB;AACd,aAAKA,KAAL,CAAW;AAACC,UAAAA,IAAI,EAAE1E,KAAP;AAAc4B,UAAAA,MAAM,EAANA,MAAd;AAAsBC,UAAAA,MAAM,EAANA,MAAtB;AAA8BC,UAAAA,IAAI,EAAJA;AAA9B,SAAX;AACD;;AACD,UAAMsD,aAAa,GAAG,KAAKC,iBAAL,CAAuBzD,MAAvB,CAAtB;AACAhC,MAAAA,SAAS,CACP,CAAC,CAACwF,aADK,cAEGxD,MAFH,sDAE0DC,MAF1D,4NAAT;AAKAjC,MAAAA,SAAS,CACP,CAAC,CAACwF,aAAa,CAACvD,MAAD,CADR,cAEGA,MAFH,kCAEsCD,MAFtC,CAAT;AAIAwD,MAAAA,aAAa,CAACvD,MAAD,CAAb,CAAsByD,KAAtB,CAA4BF,aAA5B,EAA2CtD,IAA3C;AACApC,MAAAA,QAAQ,CAACyF,QAAT;AACD;;;WAED,0BAAiBlD,IAAjB,EAA+BH,IAA/B,EAA8C;AAC5C,WAAKf,UAAL,GAAkBE,IAAI,CAACC,GAAL,EAAlB;AACA,WAAKF,mBAAL,GAA2B,KAAKD,UAAhC;AAIA,UAAMsC,MAAM,GAAGpB,IAAI,KAAK,CAAxB;AAEA,UAAMsD,SAAS,GAAGtD,IAAI,GAAG,CAAzB;AACA,UAAMuD,QAAQ,GAAGD,SAAS,GACtB,KAAK5E,iBAAL,CAAuB8E,GAAvB,CAA2BpC,MAA3B,CADsB,GAEtB,KAAKxC,iBAAL,CAAuB4E,GAAvB,CAA2BpC,MAA3B,CAFJ;;AAIA,UAAIjC,OAAJ,EAAa;AACX,YAAMkC,KAAK,GAAG,KAAKjC,UAAL,CAAgBgC,MAAhB,CAAd;;AACA,YAAMzB,OAAM,GAAG0B,KAAK,IAAI,KAAKhC,kBAAL,CAAwBgC,KAAK,CAAC,CAAD,CAA7B,CAAxB;;AACA,YAAMzB,MAAM,GAAGyB,KAAK,IAAI,KAAK/B,kBAAL,CAAwB+B,KAAK,CAAC,CAAD,CAA7B,EAAkCA,KAAK,CAAC,CAAD,CAAvC,CAAxB;AACA1D,QAAAA,SAAS,CACP4F,QADO,EAEP,iCAA+BvD,IAA/B,oBAAkDoB,MAAlD,cACGxB,MAAM,SACCD,OADD,SACWC,MADX,oEAEOD,OAAM,IAAI,WAFjB,CADT,mBAIc/B,aAAa,CAACiC,IAAD,CAJ3B,OAFO,CAAT;AAQA,YAAM4D,WAAW,GAAGpC,KAAK,GACrB,mBAAmB1B,OAAnB,GAA4B,GAA5B,GAAkCC,MAAlC,GAA2C,GADtB,GAErBI,IAFJ;;AAGA,YAAIuD,QAAQ,IAAI,KAAKf,KAArB,EAA4B;AAC1B,eAAKA,KAAL,CAAW;AAACC,YAAAA,IAAI,EAAE1E,KAAP;AAAc4B,YAAAA,MAAM,EAAE,IAAtB;AAA4BC,YAAAA,MAAM,EAAE6D,WAApC;AAAiD5D,YAAAA,IAAI,EAAJA;AAAjD,WAAX;AACD;;AACDpC,QAAAA,QAAQ,CAACwF,UAAT,kCACiCQ,WADjC,UACiD7F,aAAa,CAACiC,IAAD,CAD9D;AAGD;;AAED,UAAI,CAAC0D,QAAL,EAAe;AACb;AACD;;AAED,WAAK7E,iBAAL,CAAuBgF,MAAvB,CAA8BtC,MAA9B;;AACA,WAAKxC,iBAAL,CAAuB8E,MAAvB,CAA8BtC,MAA9B;;AACAmC,MAAAA,QAAQ,MAAR,4BAAY1D,IAAZ;;AAEA,UAAIV,OAAJ,EAAa;AACX1B,QAAAA,QAAQ,CAACyF,QAAT;AACD;AACF;;;WAtXD,aAAWS,WAAX,EAA6D;AAC3D,UAAIA,WAAW,KAAK,IAApB,EAA0B;AACxBpF,QAAAA,YAAY,CAACqF,SAAb,CAAuBpB,KAAvB,GAA+B,UAAAvB,IAAI,EAAI;AACrC4C,UAAAA,OAAO,CAACC,GAAR,CACE,CAAG7C,IAAI,CAACwB,IAAL,KAAc1E,KAAd,GAAsB,OAAtB,GAAgC,OAAnC,mBACKkD,IAAI,CAACtB,MAAL,IAAe,IAAf,GAAsBsB,IAAI,CAACtB,MAAL,GAAc,GAApC,GAA0C,EAD/C,IACoDsB,IAAI,CAACrB,MADzD,WAEMwC,IAAI,CAACC,SAAL,CAAepB,IAAI,CAACpB,IAApB,CAFN,OADF;AAKD,SAND;AAOD,OARD,MAQO,IAAI8D,WAAW,KAAK,KAApB,EAA2B;AAChCpF,QAAAA,YAAY,CAACqF,SAAb,CAAuBpB,KAAvB,GAA+B,IAA/B;AACD,OAFM,MAEA;AACLjE,QAAAA,YAAY,CAACqF,SAAb,CAAuBpB,KAAvB,GAA+BmB,WAA/B;AACD;AACF;;;;;;AA2WHhE,MAAM,CAACoE,OAAP,GAAiBxF,YAAjB","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow strict\n * @format\n */\n\n'use strict';\n\nconst ErrorUtils = require('../vendor/core/ErrorUtils');\nconst Systrace = require('../Performance/Systrace');\n\nconst deepFreezeAndThrowOnMutationInDev = require('../Utilities/deepFreezeAndThrowOnMutationInDev');\nconst invariant = require('invariant');\nconst stringifySafe = require('../Utilities/stringifySafe').default;\nconst warnOnce = require('../Utilities/warnOnce');\n\nexport type SpyData = {\n  type: number,\n  module: ?string,\n  method: string | number,\n  args: mixed[],\n  ...\n};\n\nconst TO_JS = 0;\nconst TO_NATIVE = 1;\n\nconst MODULE_IDS = 0;\nconst METHOD_IDS = 1;\nconst PARAMS = 2;\nconst MIN_TIME_BETWEEN_FLUSHES_MS = 5;\n\n// eslint-disable-next-line no-bitwise\nconst TRACE_TAG_REACT_APPS = 1 << 17;\n\nconst DEBUG_INFO_LIMIT = 32;\n\nclass MessageQueue {\n  _lazyCallableModules: {[key: string]: (void) => {...}, ...};\n  _queue: [number[], number[], mixed[], number];\n  _successCallbacks: Map<number, ?(...mixed[]) => void>;\n  _failureCallbacks: Map<number, ?(...mixed[]) => void>;\n  _callID: number;\n  _lastFlush: number;\n  _eventLoopStartTime: number;\n  _immediatesCallback: ?() => void;\n\n  _debugInfo: {[number]: [number, number], ...};\n  _remoteModuleTable: {[number]: string, ...};\n  _remoteMethodTable: {[number]: $ReadOnlyArray<string>, ...};\n\n  __spy: ?(data: SpyData) => void;\n\n  constructor() {\n    this._lazyCallableModules = {};\n    this._queue = [[], [], [], 0];\n    this._successCallbacks = new Map();\n    this._failureCallbacks = new Map();\n    this._callID = 0;\n    this._lastFlush = 0;\n    this._eventLoopStartTime = Date.now();\n    this._immediatesCallback = null;\n\n    if (__DEV__) {\n      this._debugInfo = {};\n      this._remoteModuleTable = {};\n      this._remoteMethodTable = {};\n    }\n\n    // $FlowFixMe[cannot-write]\n    this.callFunctionReturnFlushedQueue = this.callFunctionReturnFlushedQueue.bind(\n      this,\n    );\n    // $FlowFixMe[cannot-write]\n    this.flushedQueue = this.flushedQueue.bind(this);\n\n    // $FlowFixMe[cannot-write]\n    this.invokeCallbackAndReturnFlushedQueue = this.invokeCallbackAndReturnFlushedQueue.bind(\n      this,\n    );\n  }\n\n  /**\n   * Public APIs\n   */\n\n  static spy(spyOrToggle: boolean | ((data: SpyData) => void)) {\n    if (spyOrToggle === true) {\n      MessageQueue.prototype.__spy = info => {\n        console.log(\n          `${info.type === TO_JS ? 'N->JS' : 'JS->N'} : ` +\n            `${info.module != null ? info.module + '.' : ''}${info.method}` +\n            `(${JSON.stringify(info.args)})`,\n        );\n      };\n    } else if (spyOrToggle === false) {\n      MessageQueue.prototype.__spy = null;\n    } else {\n      MessageQueue.prototype.__spy = spyOrToggle;\n    }\n  }\n\n  callFunctionReturnFlushedQueue(\n    module: string,\n    method: string,\n    args: mixed[],\n  ): null | [Array<number>, Array<number>, Array<mixed>, number] {\n    this.__guard(() => {\n      this.__callFunction(module, method, args);\n    });\n\n    return this.flushedQueue();\n  }\n\n  invokeCallbackAndReturnFlushedQueue(\n    cbID: number,\n    args: mixed[],\n  ): null | [Array<number>, Array<number>, Array<mixed>, number] {\n    this.__guard(() => {\n      this.__invokeCallback(cbID, args);\n    });\n\n    return this.flushedQueue();\n  }\n\n  flushedQueue(): null | [Array<number>, Array<number>, Array<mixed>, number] {\n    this.__guard(() => {\n      this.__callImmediates();\n    });\n\n    const queue = this._queue;\n    this._queue = [[], [], [], this._callID];\n    return queue[0].length ? queue : null;\n  }\n\n  getEventLoopRunningTime(): number {\n    return Date.now() - this._eventLoopStartTime;\n  }\n\n  registerCallableModule(name: string, module: {...}) {\n    this._lazyCallableModules[name] = () => module;\n  }\n\n  registerLazyCallableModule(name: string, factory: void => {...}) {\n    let module: {...};\n    let getValue: ?(void) => {...} = factory;\n    this._lazyCallableModules[name] = () => {\n      if (getValue) {\n        module = getValue();\n        getValue = null;\n      }\n      return module;\n    };\n  }\n\n  getCallableModule(name: string): {...} | null {\n    const getValue = this._lazyCallableModules[name];\n    return getValue ? getValue() : null;\n  }\n\n  callNativeSyncHook(\n    moduleID: number,\n    methodID: number,\n    params: mixed[],\n    onFail: ?(...mixed[]) => void,\n    onSucc: ?(...mixed[]) => void,\n  ): mixed {\n    if (__DEV__) {\n      invariant(\n        global.nativeCallSyncHook,\n        'Calling synchronous methods on native ' +\n          'modules is not supported in Chrome.\\n\\n Consider providing alternative ' +\n          'methods to expose this method in debug mode, e.g. by exposing constants ' +\n          'ahead-of-time.',\n      );\n    }\n    this.processCallbacks(moduleID, methodID, params, onFail, onSucc);\n    return global.nativeCallSyncHook(moduleID, methodID, params);\n  }\n\n  processCallbacks(\n    moduleID: number,\n    methodID: number,\n    params: mixed[],\n    onFail: ?(...mixed[]) => void,\n    onSucc: ?(...mixed[]) => void,\n  ): void {\n    if (onFail || onSucc) {\n      if (__DEV__) {\n        this._debugInfo[this._callID] = [moduleID, methodID];\n        if (this._callID > DEBUG_INFO_LIMIT) {\n          delete this._debugInfo[this._callID - DEBUG_INFO_LIMIT];\n        }\n        if (this._successCallbacks.size > 500) {\n          const info = {};\n          this._successCallbacks.forEach((_, callID) => {\n            const debug = this._debugInfo[callID];\n            const module = debug && this._remoteModuleTable[debug[0]];\n            const method = debug && this._remoteMethodTable[debug[0]][debug[1]];\n            info[callID] = {module, method};\n          });\n          warnOnce(\n            'excessive-number-of-pending-callbacks',\n            `Please report: Excessive number of pending callbacks: ${\n              this._successCallbacks.size\n            }. Some pending callbacks that might have leaked by never being called from native code: ${stringifySafe(\n              info,\n            )}`,\n          );\n        }\n      }\n      // Encode callIDs into pairs of callback identifiers by shifting left and using the rightmost bit\n      // to indicate fail (0) or success (1)\n      // eslint-disable-next-line no-bitwise\n      onFail && params.push(this._callID << 1);\n      // eslint-disable-next-line no-bitwise\n      onSucc && params.push((this._callID << 1) | 1);\n      this._successCallbacks.set(this._callID, onSucc);\n      this._failureCallbacks.set(this._callID, onFail);\n    }\n    if (__DEV__) {\n      global.nativeTraceBeginAsyncFlow &&\n        global.nativeTraceBeginAsyncFlow(\n          TRACE_TAG_REACT_APPS,\n          'native',\n          this._callID,\n        );\n    }\n    this._callID++;\n  }\n\n  enqueueNativeCall(\n    moduleID: number,\n    methodID: number,\n    params: mixed[],\n    onFail: ?(...mixed[]) => void,\n    onSucc: ?(...mixed[]) => void,\n  ) {\n    this.processCallbacks(moduleID, methodID, params, onFail, onSucc);\n\n    this._queue[MODULE_IDS].push(moduleID);\n    this._queue[METHOD_IDS].push(methodID);\n\n    if (__DEV__) {\n      // Validate that parameters passed over the bridge are\n      // folly-convertible.  As a special case, if a prop value is a\n      // function it is permitted here, and special-cased in the\n      // conversion.\n      const isValidArgument = val => {\n        switch (typeof val) {\n          case 'undefined':\n          case 'boolean':\n          case 'string':\n            return true;\n          case 'number':\n            return isFinite(val);\n          case 'object':\n            if (val == null) {\n              return true;\n            }\n\n            if (Array.isArray(val)) {\n              return val.every(isValidArgument);\n            }\n\n            for (const k in val) {\n              if (typeof val[k] !== 'function' && !isValidArgument(val[k])) {\n                return false;\n              }\n            }\n\n            return true;\n          case 'function':\n            return false;\n          default:\n            return false;\n        }\n      };\n\n      // Replacement allows normally non-JSON-convertible values to be\n      // seen.  There is ambiguity with string values, but in context,\n      // it should at least be a strong hint.\n      const replacer = (key, val) => {\n        const t = typeof val;\n        if (t === 'function') {\n          return '<<Function ' + val.name + '>>';\n        } else if (t === 'number' && !isFinite(val)) {\n          return '<<' + val.toString() + '>>';\n        } else {\n          return val;\n        }\n      };\n\n      // Note that JSON.stringify\n      invariant(\n        isValidArgument(params),\n        '%s is not usable as a native method argument',\n        JSON.stringify(params, replacer),\n      );\n\n      // The params object should not be mutated after being queued\n      deepFreezeAndThrowOnMutationInDev(params);\n    }\n    this._queue[PARAMS].push(params);\n\n    const now = Date.now();\n    if (\n      global.nativeFlushQueueImmediate &&\n      now - this._lastFlush >= MIN_TIME_BETWEEN_FLUSHES_MS\n    ) {\n      const queue = this._queue;\n      this._queue = [[], [], [], this._callID];\n      this._lastFlush = now;\n      global.nativeFlushQueueImmediate(queue);\n    }\n    Systrace.counterEvent('pending_js_to_native_queue', this._queue[0].length);\n    if (__DEV__ && this.__spy && isFinite(moduleID)) {\n      this.__spy({\n        type: TO_NATIVE,\n        module: this._remoteModuleTable[moduleID],\n        method: this._remoteMethodTable[moduleID][methodID],\n        args: params,\n      });\n    } else if (this.__spy) {\n      this.__spy({\n        type: TO_NATIVE,\n        module: moduleID + '',\n        method: methodID,\n        args: params,\n      });\n    }\n  }\n\n  createDebugLookup(\n    moduleID: number,\n    name: string,\n    methods: ?$ReadOnlyArray<string>,\n  ) {\n    if (__DEV__) {\n      this._remoteModuleTable[moduleID] = name;\n      this._remoteMethodTable[moduleID] = methods || [];\n    }\n  }\n\n  // For JSTimers to register its callback. Otherwise a circular dependency\n  // between modules is introduced. Note that only one callback may be\n  // registered at a time.\n  setImmediatesCallback(fn: () => void) {\n    this._immediatesCallback = fn;\n  }\n\n  /**\n   * Private methods\n   */\n\n  __guard(fn: () => void) {\n    if (this.__shouldPauseOnThrow()) {\n      fn();\n    } else {\n      try {\n        fn();\n      } catch (error) {\n        ErrorUtils.reportFatalError(error);\n      }\n    }\n  }\n\n  // MessageQueue installs a global handler to catch all exceptions where JS users can register their own behavior\n  // This handler makes all exceptions to be propagated from inside MessageQueue rather than by the VM at their origin\n  // This makes stacktraces to be placed at MessageQueue rather than at where they were launched\n  // The parameter DebuggerInternal.shouldPauseOnThrow is used to check before catching all exceptions and\n  // can be configured by the VM or any Inspector\n  __shouldPauseOnThrow(): boolean {\n    return (\n      // $FlowFixMe\n      typeof DebuggerInternal !== 'undefined' &&\n      DebuggerInternal.shouldPauseOnThrow === true // eslint-disable-line no-undef\n    );\n  }\n\n  __callImmediates() {\n    Systrace.beginEvent('JSTimers.callImmediates()');\n    if (this._immediatesCallback != null) {\n      this._immediatesCallback();\n    }\n    Systrace.endEvent();\n  }\n\n  __callFunction(module: string, method: string, args: mixed[]): void {\n    this._lastFlush = Date.now();\n    this._eventLoopStartTime = this._lastFlush;\n    if (__DEV__ || this.__spy) {\n      Systrace.beginEvent(`${module}.${method}(${stringifySafe(args)})`);\n    } else {\n      Systrace.beginEvent(`${module}.${method}(...)`);\n    }\n    if (this.__spy) {\n      this.__spy({type: TO_JS, module, method, args});\n    }\n    const moduleMethods = this.getCallableModule(module);\n    invariant(\n      !!moduleMethods,\n      `Module ${module} is not a registered callable module (calling ${method}). A frequent cause of the error is that the application entry file path is incorrect. \n      This can also happen when the JS bundle is corrupt or there is an early initialization error when loading React Native.`,\n    );\n    invariant(\n      !!moduleMethods[method],\n      `Method ${method} does not exist on module ${module}`,\n    );\n    moduleMethods[method].apply(moduleMethods, args);\n    Systrace.endEvent();\n  }\n\n  __invokeCallback(cbID: number, args: mixed[]) {\n    this._lastFlush = Date.now();\n    this._eventLoopStartTime = this._lastFlush;\n\n    // The rightmost bit of cbID indicates fail (0) or success (1), the other bits are the callID shifted left.\n    // eslint-disable-next-line no-bitwise\n    const callID = cbID >>> 1;\n    // eslint-disable-next-line no-bitwise\n    const isSuccess = cbID & 1;\n    const callback = isSuccess\n      ? this._successCallbacks.get(callID)\n      : this._failureCallbacks.get(callID);\n\n    if (__DEV__) {\n      const debug = this._debugInfo[callID];\n      const module = debug && this._remoteModuleTable[debug[0]];\n      const method = debug && this._remoteMethodTable[debug[0]][debug[1]];\n      invariant(\n        callback,\n        `No callback found with cbID ${cbID} and callID ${callID} for ` +\n          (method\n            ? ` ${module}.${method} - most likely the callback was already invoked`\n            : `module ${module || '<unknown>'}`) +\n          `. Args: '${stringifySafe(args)}'`,\n      );\n      const profileName = debug\n        ? '<callback for ' + module + '.' + method + '>'\n        : cbID;\n      if (callback && this.__spy) {\n        this.__spy({type: TO_JS, module: null, method: profileName, args});\n      }\n      Systrace.beginEvent(\n        `MessageQueue.invokeCallback(${profileName}, ${stringifySafe(args)})`,\n      );\n    }\n\n    if (!callback) {\n      return;\n    }\n\n    this._successCallbacks.delete(callID);\n    this._failureCallbacks.delete(callID);\n    callback(...args);\n\n    if (__DEV__) {\n      Systrace.endEvent();\n    }\n  }\n}\n\nmodule.exports = MessageQueue;\n"]},"metadata":{},"sourceType":"script"}